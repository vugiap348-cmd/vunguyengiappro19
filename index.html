<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Đề Kiểm Tra Lịch Sử Số 18</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
            line-height: 1.6;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 28px;
            margin-bottom: 10px;
        }

        .timer {
            background: rgba(255,255,255,0.2);
            padding: 15px;
            border-radius: 10px;
            margin-top: 15px;
            font-size: 24px;
            font-weight: bold;
        }

        .timer.warning {
            background: rgba(255,0,0,0.3);
            animation: pulse 1s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

        .content {
            padding: 30px;
        }

        .section-title {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px;
            border-radius: 8px;
            margin: 30px 0 20px 0;
            font-size: 20px;
            font-weight: bold;
        }

        .question {
            background: #f8f9fa;
            padding: 20px;
            margin-bottom: 20px;
            border-radius: 10px;
            border-left: 5px solid #667eea;
        }

        .question-title {
            font-weight: bold;
            margin-bottom: 15px;
            color: #333;
            font-size: 16px;
        }

        .options {
            margin-left: 20px;
        }

        .option {
            margin: 10px 0;
            display: flex;
            align-items: flex-start;
        }

        .option input[type="radio"],
        .option input[type="checkbox"] {
            margin-right: 10px;
            margin-top: 4px;
            cursor: pointer;
            width: 18px;
            height: 18px;
        }

        .option label {
            cursor: pointer;
            flex: 1;
        }

        .document-box {
            background: #fff8dc;
            border: 2px solid #daa520;
            padding: 15px;
            margin: 15px 0;
            border-radius: 8px;
            font-style: italic;
            line-height: 1.8;
        }

        .submit-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px 40px;
            border: none;
            border-radius: 8px;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            display: block;
            margin: 30px auto;
            transition: transform 0.2s;
        }

        .submit-btn:hover {
            transform: scale(1.05);
        }

        .submit-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
        }

        .result-box {
            background: #e8f5e9;
            border: 3px solid #4caf50;
            padding: 25px;
            margin: 20px 0;
            border-radius: 10px;
            display: none;
        }

        .result-box.show {
            display: block;
        }

        .score {
            font-size: 32px;
            font-weight: bold;
            color: #2e7d32;
            text-align: center;
            margin: 20px 0;
        }

        .correct {
            background: #c8e6c9 !important;
            border-left-color: #4caf50 !important;
        }

        .incorrect {
            background: #ffcdd2 !important;
            border-left-color: #f44336 !important;
        }

        .correct-answer {
            color: #2e7d32;
            font-weight: bold;
            margin-top: 10px;
        }

        .user-answer {
            color: #c62828;
            font-weight: bold;
            margin-top: 5px;
        }

        .instruction {
            background: #e3f2fd;
            border-left: 4px solid #2196f3;
            padding: 15px;
            margin-bottom: 20px;
            border-radius: 5px;
        }

        .part2-item {
            margin-bottom: 15px;
            padding-left: 20px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 10px 0;
        }

        th, td {
            border: 1px solid #ccc;
            padding: 10px;
            text-align: left;
        }

        th {
            background: #f0f0f0;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ĐỀ KIỂM TRA SỐ 18 - MÔN LỊCH SỬ</h1>
            <div class="timer" id="timer">Thời gian: 45:00</div>
        </div>

        <div class="content">
            <div class="instruction">
                <strong>Hướng dẫn:</strong><br>
                - Phần I: Mỗi câu hỏi chỉ chọn một phương án (24 câu × 0.25 điểm = 6 điểm)<br>
                - Phần II: Mỗi câu có 4 ý a, b, c, d - chọn Đúng hoặc Sai (4 câu, thang điểm: 1 ý đúng = 0.1đ, 2 ý = 0.25đ, 3 ý = 0.5đ, 4 ý = 1.0đ)<br>
                - Thời gian làm bài: 45 phút<br>
                - Nhấn "Nộp bài" để xem kết quả và đáp án
            </div>

            <div class="section-title">PHẦN I: Thí sinh trả lời câu hỏi từ 1 đến 24. Mỗi câu hỏi thí sinh chỉ chọn một phương án.</div>
            
            <div id="part1-questions"></div>

            <div class="section-title">PHẦN II: Thí sinh trả lời câu hỏi từ 1 đến 4. Trong mỗi ý a), b), c), d) ở mỗi câu, thí sinh chọn đúng hoặc sai.</div>
            
            <div id="part2-questions"></div>

            <button class="submit-btn" id="submitBtn">Nộp bài</button>

            <div class="result-box" id="resultBox">
                <h2 style="text-align: center; color: #2e7d32;">KẾT QUẢ BÀI KIỂM TRA</h2>
                <div class="score" id="scoreDisplay"></div>
                <div id="detailScore"></div>
            </div>
        </div>
    </div>

    <script>
        const part1Questions = [
            {id: 1, question: "Đặc khu kinh tế hàng đầu ở Trung Quốc hiện nay là", options: ["Thâm Quyến.", "Thượng Hải.", "Bắc Kinh.", "Trùng Khánh."], correct: 0},
            {id: 2, question: "Trung Quốc thử thành công bom nguyên tử (1964), phóng nhiều vệ tinh nhân tạo và phóng thành công tàu \"Thần Châu 5\" (2003) đã chứng tỏ", options: ["trình độ khoa học – kĩ thuật của Trung Quốc có bước phát triển vượt bậc.", "Trung Quốc đã trở thành nước khởi đầu cho quá trình chinh phục vũ trụ.", "Trung Quốc là nước khởi đầu cuộc cách mạng khoa học công nghệ lần ba.", "về trình độ khoa học công nghệ của Trung Quốc phát triển vượt qua Mỹ."], correct: 0},
            {id: 3, question: "Cuộc khởi nghĩa Lý Nam Đế (542 – 544) nhằm lật đổ ách thống trị của triều đại nào?", options: ["Lương.", "Đường.", "Tống.", "Nguyên."], correct: 0},
            {id: 4, question: "Trong thời Bắc thuộc, người Việt đã đánh bại âm mưu đồng hóa do các triều đại phong kiến Trung Hoa tiến hành không xuất phát từ nguyên nhân nào sau đây?", options: ["Các cuộc khởi nghĩa diễn ra liên tục.", "Tính cộng đồng, tinh thần yêu nước.", "Nền kinh tế công nghiệp sớm phát triển.", "Tiếp thu có chọn lọc văn hóa Trung Hoa."], correct: 2},
            {id: 5, question: "Một trong những nội dung của mục tiêu, hành động mang tính toàn cầu đến năm 2030 của Liên hợp quốc là", options: ["chống thất nạn nghiệp.", "quyền tự do chính trị.", "chống bạo lực gia đình.", "xóa đói, tài nguyên đất."], correct: 3},
            {id: 6, question: "Nội dung nào sau đây không phản ánh đúng đặc điểm, bản chất của Chiến tranh lạnh?", options: ["Do Mĩ phát động nhằm chống Liên Xô và các nước xã hội chủ nghĩa.", "Đối đầu căng thẳng giữa hai phe tư bản chủ nghĩa và xã hội chủ nghĩa.", "Là cuộc đối đầu trực tiếp trên lĩnh vực quân sự giữa hai nước Xô - Mĩ.", "Thế giới đã bị chia thành hai phe tư bản chủ nghĩa và xã hội chủ nghĩa."], correct: 2},
            {id: 7, question: "Nguyên tắc nào sau đây không được xác định trong Hiệp ước Bali (2-1976) của tổ chức ASEAN?", options: ["Tôn trọng độc lập, chủ quyền và toàn vẹn lãnh thổ", "Không sử dụng vũ lực, đe dọa dùng vũ lực với nhau.", "Giải quyết các tranh chấp bằng biện pháp hòa bình.", "Đề xuất lộ trình để xây dựng cộng đồng ASEAN."], correct: 3},
            {id: 8, question: "Khi thành lập (1967), Hiệp hội các quốc gia Đông Nam Á (ASEAN) xác định mục tiêu của tổ chức là", options: ["đẩy mạnh hợp tác quân sự trên cơ sở tôn trọng độc lập và toàn vẹn lãnh thổ.", "phát triển kinh tế và văn hóa trên tinh thần duy trì hòa bình và ổn định khu vực.", "xúc tiến giải quyết hòa bình các nguy cơ an ninh phi truyền thống ở Đông Nam Á.", "tăng cường đoàn kết để gạt bỏ ảnh hưởng của các nước phương Tây khỏi khu vực."], correct: 1},
            {id: 9, question: "Tính chất của Cộng đồng chính trị - an ninh (APSC) là", options: ["phi quân sự.", "phi hạt nhân.", "phòng thủ chung.", "liên minh quân sự."], correct: 0},
            {id: 10, question: "Địa phương nào sau đây không giành được chính quyền trong Tổng khởi nghĩa tháng Tám năm 1945?", options: ["Cần Thơ.", "Lai Châu.", "Hà Nội.", "Sài Gòn."], correct: 1},
            {id: 11, question: "Đảng Lao động Việt Nam là tên gọi mới của Đảng Cộng sản Đông Dương bắt đầu được sử dụng từ sự kiện nào sau đây?", options: ["Hội nghị Ban chấp hành Trung ương 6.", "Hội nghị Ban chấp hành Trung ương 8.", "Đại hội đại biểu toàn quốc lần III (1960).", "Đại hội đại biểu toàn quốc lần II (1951)."], correct: 3},
            {id: 12, question: "Nội dung nào sau đây phản ánh đúng âm mưu của Pháp – Mĩ khi xây dựng tập đoàn cứ điểm Điện Biên Phủ?", options: ["Thu hút và tiêu diệt bộ đội chủ lực Việt Nam.", "Bảo vệ vùng Tây Bắc, khóa chặt biên giới.", "Giành lại thế chủ động trên chiến trường.", "Ngăn chặn sự liên lạc giữa Việt Nam với Lào."], correct: 0},
            {id: 13, question: "Một trong những điểm mới trong Đại hội Đại biểu lần thứ II của Đảng Cộng sản Đông Dương (2 - 1951) là", options: ["đề cao nhiệm vụ giải phóng dân tộc.", "xác định nhiệm cách mạng từng miền.", "đã đưa Đảng ra hoạt động công khai.", "giải tán Đảng Cộng sản Đông Dương."], correct: 2},
            {id: 14, question: "Nội dung nào sau đây không thể hiện đúng đường lối đổi mới kinh tế của Đảng Cộng sản Việt Nam giai đoạn 1996 - 2006?", options: ["Phát triển nền kinh tế thị trường theo định hướng xã hội chủ nghĩa.", "Chuyển dịch cơ cấu kinh tế theo hướng công nghiệp hoá, hiện đại hoá.", "Tổ chức tái cơ cấu các công ty do nhà nước nắm dưới 50% vốn điều lệ.", "Gắn tăng trưởng kinh tế với thực hiện tiến bộ và công bằng xã hội."], correct: 2},
            {id: 15, question: "Đảng Cộng sản Việt Nam xác định lấy đổi mới kinh tế làm trọng tâm không xuất phát từ lí do nào sau đây?", options: ["Kinh nghiệm của Liên Xô khi cải tổ.", "Đòi hỏi cấp bách, cần thiết của nhân dân.", "Đây là điều kiện tiên quyết để đổi mới.", "Cơ sở đổi mới trên những lĩnh vực khác."], correct: 2},
            {id: 16, question: "Đầu thế kỷ XXI, Việt Nam đã thiết lập, nâng cấp quan hệ đối tác chiến lược toàn diện với quốc gia nào sau đây?", options: ["Nga.", "Đức.", "Anh.", "Lào."], correct: 0},
            {id: 17, question: "Trong giai đoạn 1946 – 1954 văn bản ngoại giao nào sau đây không được ký kết?", options: ["Hiệp định Sơ bộ.", "Hiệp ước Nhâm Tuất.", "Tạm ước Việt – Pháp.", "Hiệp định Giơ-ne-vơ."], correct: 1},
            {id: 18, question: "Sự kiện nào đây có ý nghĩa là bước ngoặt mới đối với cuộc kháng chiến chống Mỹ cứu nước 1954-1975 của nhân dân Việt Nam?", options: ["Hội nghị cấp cao ba nước Đông Dương.", "Cuộc tiến công chiến lược năm 1972.", "Hiệp định Paris được ký kết (1973).", "Chiến thắng Lam Sơn 719 (1971)."], correct: 2},
            {id: 19, question: "Trong giai đoạn hoạt động cách mạng từ 1911 đến 1929, Nguyễn Ái Quốc không có hoạt động nào sau đây?", options: ["Tiếp nhận chủ nghĩa Mác – Lênin, xây dựng lý luận cách mạng giải phóng dân tộc.", "Lập tổ chức tiền thân của  Đảng, đào tạo, huấn luyện lớp cán bộ cách mạng đầu tiên.", "Góp phần gắn phong trào cách mạng Việt Nam với phong trào cách mạng thế giới.", "Tổ chức hội nghị hợp nhất các tổ chức cộng sản, lập ra Đảng Cộng sản Việt Nam."], correct: 3},
            {id: 20, question: "Tại Hội nghị lần thứ 8 Ban Chấp hành Trung ương Đảng Cộng sản Đông Dương (5-1941), Nguyễn Ái Quốc đưa ra sáng kiến thành lập", options: ["Hội Liên Việt.", "Mặt trận Việt Minh.", "Mặt trận Liên Việt.", "Liên minh Việt – Lào."], correct: 1},
            {id: 21, question: "Nội dung nào sau đây là đúng về nhận thức mới của Nguyễn Ái Quốc trong thời gian hoạt động cách mạng từ 1919 - 1929?", options: ["Nhân dân lao động ở đâu cũng là bạn, chủ nghĩa đế quốc ở đâu cũng là thù.", "Muốn giải phóng dân tộc, phải trông cậy vào lực lượng cách mạng thế giới.", "Quốc tế Cộng sản sẽ lãnh đạo nhân dân các thuộc địa đứng lên tự giải phóng.", "Đội tiên phong của giai cấp vô sản sẽ đại diện cho quyền lợi của toàn dân tộc."], correct: 3},
            {id: 22, question: "Thực tiễn công cuộc Đổi mới kinh tế ở Việt Nam (từ năm 1986) để lại bài học kinh nghiệm nào sau đây?", options: ["Chủ động hạn chế kinh tế thị trường vì đó là sản phẩm của chủ nghĩa tư bản.", "Tiến hành tư nhân hoá, tự do hoá nền kinh tế để đẩy mạnh hội nhập kinh tế.", "Đổi mới toàn bộ các ngành kinh tế với tốc độ nhanh nhất, thúc đẩy sản xuất.", "Xây dựng nền kinh tế thị trường với mục tiêu phục vụ lợi ích của nhân dân."], correct: 3},
            {id: 23, question: "Nội dung nào sau đây phải ánh không đúng những bài học rút ra từ thắng lợi của chiến dịch Điện Biên Phủ (1954) đối với sự nghiệp xây dựng và bảo vệ Tổ quốc hiện nay?", options: ["Xây dựng khối đại đoàn kết toàn Đảng, toàn quân, toàn dân", "Phát huy tinh thần yêu nước, ý chí quyết chiến, quyết thắng.", "Dựa vào nhân dân để giải quyết khó khăn thực tế trong nước.", "Dùng sức mạnh quân sự để giải quyết tranh chấp, xung đột."], correct: 3},
            {id: 24, question: "Nhận xét nào sau đây là tác động của Hội nghị I-an-ta và Hội nghị Pốt-xđam (1945) đối với tình hình quốc tế?", options: ["Làm thay đổi sâu sắc quan hệ quốc tế, đặc biệt là quan hệ Xô - Mỹ.", "Giải quyết được mâu thuẫn về vấn đề thị trường cho các cường quốc.", "Tạo nên khuôn khổ của trật tự thế giới – trật tự nhất siêu, nhiều cực.", "Tạo nên một trật tự thế giới mới giữa các nước thắng trận và bại trận."], correct: 0}
        ];

        const part2Questions = [
            {
                id: 1,
                question: "Cho những thông tin trong bảng sau đây:",
                document: '<table><tr><th>Thời gian</th><th>Nội dung</th></tr><tr><td>Từ năm 1975 đến năm 1977</td><td>Quân Pôn-Pốt tấn công toàn tuyến biên giới Tây Nam.</td></tr><tr><td>Tháng 4 năm 1977</td><td>Chế độ Khơ-me đỏ bị lật đổ.</td></tr><tr><td>Tháng 12 năm 1978</td><td>Quân Pôn-Pốt gây ra hàng loạt vụ thảm sát.</td></tr><tr><td>Tháng 1 năm 1979</td><td>Quân Pôn-Pốt liên tục khiêu khích xâm phạm biên giới Việt Nam.</td></tr><tr><td>Cuối những năm 80</td><td>Việt Nam rút quân từ Campuchia về nước.</td></tr></table>',
                subQuestions: [
                    {id: 'a', text: "Tư liệu đề cập đến nét chính về diễn biến của cuộc đấu tranh bảo vệ biên giới Tây Nam và làm nghĩa vụ quốc tế sau năm 1975.", correct: true},
                    {id: 'b', text: "Sau năm 1975, Việt Nam phải tiến hành cuộc chiến tranh ở biên giới Tây Nam nhằm giải phóng dân tộc và bảo vệ tổ quốc.", correct: false},
                    {id: 'c', text: "Cuộc đấu tranh bảo vệ biên giới phía Tây Nam và làm nghĩa vụ quốc tế của Việt Nam là một cuộc chiến tranh chính nghĩa.", correct: true},
                    {id: 'd', text: "Cuộc đấu tranh bảo vệ biên giới Tây Nam sau năm 1975 đã góp phần bảo vệ và mở rộng lãnh thổ quốc gia của Việt Nam.", correct: false}
                ]
            },
            {
                id: 2,
                question: "Cho đoạn tư liệu sau đây:",
                document: '"Sau khi tiến hành Đổi mới Việt Nam đã nhanh chóng tiếp tục bố trí lại lực lượng quốc phòng, điều chỉnh lại thế đứng chân của các đơn vị bộ đội chủ lực, tạo ra thế phòng thủ hợp lý, vững chắc trên phạm vi cả nước và từng địa phương, tập trung vào các khu vực trọng điểm ở địa bàn chiến lược, hướng chiến lược. Phương án, kế hoạch phòng thủ chiến lược được xây dựng, bổ sung phù hợp với sự phát triển của tình hình thực tiễn, bảo đảm chủ động, sẵn sàng đối phó kịp thời, hiệu quả với các tình huống, không để đất nước bị động, bất ngờ về chiến lược."<br><em>Nguyễn Ngọc Mão (Chủ biên), Lịch sử Việt Nam, tập 15, NXB. Khoa học xã hội 2017, tr. 348</em>',
                subQuestions: [
                    {id: 'a', text: "Tư liệu đề cập đến chính sách đổi mới về kinh tế, chính trị ở Việt Nam trong công cuộc đổi mới đất nước từ năm 1986.", correct: false},
                    {id: 'b', text: "Sau khi tiến hành đổi mới, Việt Nam tiếp tục duy trì lực lượng quân sự lớn để tiến hành chiến tranh giải phóng dân tộc.", correct: false},
                    {id: 'c', text: "Công cuộc đổi mới ở Việt Nam được tiến hành toàn diện đã góp phần tăng cường năng lực để xây dựng và bảo vệ tổ quốc.", correct: true},
                    {id: 'd', text: "Việc đảm bảo vững chắc về an ninh quốc phòng đã tạo cơ sở cho công cuộc đổi mới đất nước trên các lĩnh vực khác.", correct: true}
                ]
            },
            {
                id: 3,
                question: "Cho đoạn tư liệu sau đây:",
                document: '"Việc ký kết Hiệp định Genève năm 1954 đã kết thúc thắng lợi cuộc kháng chiến chống Pháp của nhân dân Việt Nam. Hiệp định Genève đã nâng cao vị thế của Việt Nam, từ một nước sau cách mạng tháng tám (1945) chưa có quốc gia nào công nhận thì đến đây vươn lên trở thành một nước được sự thừa nhận của cộng đồng quốc tế, tạo cơ sở, động lực cho cuộc kháng chiến chống Mỹ sau này. Dù kết quả hội nghị không được như mong muốn vì đất nước vẫn còn bị chia cắt nhưng những thắng lợi cũng như những bài học kinh nghiệm mà hội nghị này mang lại là hành trang quý giá cho sự nghiệp đối ngoại của đất nước ta trong các giai đoạn tiếp theo."<br><em>Phạm Đức Thuận: Giáo trình Lịch sử ngoại giao Việt Nam, NXB Đại học Cần Thơ, 2018, tr 123</em>',
                subQuestions: [
                    {id: 'a', text: "Tư liệu đề cập đến thắng lợi đã kết thúc hoàn toàn cuộc kháng chiến chống thực dân Pháp của nhân dân Việt Nam.", correct: true},
                    {id: 'b', text: "Thắng lợi của Hiệp định Giơ ne vơ đã hoàn thành cuộc cách mạng dân tộc dân chủ nhân dân trong cả nước Việt Nam.", correct: false},
                    {id: 'c', text: "Với Hiệp định Giơ ne vơ, lần đầu tiên, nước Việt Nam đã được cộng đồng quốc tế công nhận đầy đủ các quyền dân tộc cơ bản.", correct: true},
                    {id: 'd', text: "Hiệp định Giơ ne vơ đã tạo ra cơ sở, động lực để Việt Nam tiến hành đấu tranh giải phóng và thống nhất đất nước.", correct: true}
                ]
            },
            {
                id: 4,
                question: "Cho đoạn tư liệu sau đây:",
                document: '"Để đối phó với "chủ nghĩa Tơruman" và "kế hoạch Macsan", theo sáng kiến của Đảng Cộng sản Liên Xô, tại Vacxava đã tiến hành hội nghị đại biểu các Đảng Cộng sản. Hội nghị đã thông qua bản tuyên bố, trong đó phân tích tình hình thế giới lúc này đã chia thành hai phe: phe "đế quốc" và "tư bản" (do Mỹ đứng đầu) và phe chống đế quốc, chống tư bản (do Liên Xô đứng đầu). Hội nghị quyết định thành lập cơ quan thông tin của một số Đảng Cộng sản và công nhân gọi là Cục thông tin quốc tế (KOMINFORM) với nhiệm vụ tổ chức việc thông tin, trao đổi kinh nghiệm và phối hợp hành động đấu tranh cách mạng giữa các Đảng một cách tự nguyện."<br><em>Nguyễn Anh Thái: Lịch sử thế giới hiện đại (1917 - 1995), NXB Giáo dục Việt Nam, Hà Nội, 2006, tr 236</em>',
                subQuestions: [
                    {id: 'a', text: "Tư liệu đề cập đến một trong những diễn biến của cuộc Chiến tranh lạnh giữa hai cực, hai phe sau năm 1945.", correct: true},
                    {id: 'b', text: "Cuộc Chiến tranh lạnh do Mỹ và phương Tây tiến hành đã làm xuất hiện tình trạng hai cực, hai phe trong quan hệ quốc tế.", correct: false},
                    {id: 'c', text: "Liên Xô và các nước xã hội chủ nghĩa đã thành lập Đảng Cộng sản chung nhằm mục tiêu phối hợp đấu tranh cách mạng.", correct: false},
                    {id: 'd', text: "Trong thời kỳ Chiến tranh lạnh Liên Xô là quốc gia có vai trò quan trọng góp phần duy trì hòa bình, an ninh thế giới.", correct: true}
                ]
            }
        ];

        function shuffleArray(array) {
            const newArray = [...array];
            for (let i = newArray.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [newArray[i], newArray[j]] = [newArray[j], newArray[i]];
            }
            return newArray;
        }

        const shuffledPart1 = part1Questions.map(q => {
            const shuffledOptions = shuffleArray(q.options.map((opt, idx) => ({text: opt, isCorrect: idx === q.correct})));
            return {...q, options: shuffledOptions.map(o => o.text), correct: shuffledOptions.findIndex(o => o.isCorrect)};
        });

        const shuffledPart2 = part2Questions.map(q => ({...q, subQuestions: shuffleArray(q.subQuestions)}));

        function renderPart1() {
            const container = document.getElementById('part1-questions');
            shuffledPart1.forEach(q => {
                const questionDiv = document.createElement('div');
                questionDiv.className = 'question';
                questionDiv.id = 'p1q' + q.id;
                let html = '<div class="question-title">Câu ' + q.id + '. ' + q.question + '</div><div class="options">';
                q.options.forEach((option, optIndex) => {
                    const letter = String.fromCharCode(65 + optIndex);
                    html += '<div class="option"><input type="radio" name="q' + q.id + '" id="q' + q.id + '_' + optIndex + '" value="' + optIndex + '"><label for="q' + q.id + '_' + optIndex + '">' + letter + '. ' + option + '</label></div>';
                });
                html += '</div>';
                questionDiv.innerHTML = html;
                container.appendChild(questionDiv);
            });
        }

        function renderPart2() {
            const container = document.getElementById('part2-questions');
            shuffledPart2.forEach(q => {
                const questionDiv = document.createElement('div');
                questionDiv.className = 'question';
                questionDiv.id = 'p2q' + q.id;
                let html = '<div class="question-title">Câu ' + q.id + ': ' + q.question + '</div>';
                html += '<div class="document-box">' + q.document + '</div>';
                q.subQuestions.forEach(sub => {
                    html += '<div class="part2-item"><strong>' + sub.id + ')</strong> ' + sub.text + '<br><div style="margin-top: 8px; margin-left: 20px;"><label style="margin-right: 20px;"><input type="radio" name="q' + q.id + '_' + sub.id + '" value="true"> Đúng</label><label><input type="radio" name="q' + q.id + '_' + sub.id + '" value="false"> Sai</label></div></div>';
                });
                questionDiv.innerHTML = html;
                container.appendChild(questionDiv);
            });
        }

        let timeLeft = 45 * 60;
        const timerElement = document.getElementById('timer');
        
        function updateTimer() {
            const minutes = Math.floor(timeLeft / 60);
            const seconds = timeLeft % 60;
            timerElement.textContent = 'Thời gian: ' + minutes.toString().padStart(2, '0') + ':' + seconds.toString().padStart(2, '0');
            if (timeLeft <= 5 * 60) timerElement.classList.add('warning');
            if (timeLeft <= 0) {
                clearInterval(timerInterval);
                submitExam();
            }
            timeLeft--;
        }
        
        const timerInterval = setInterval(updateTimer, 1000);

        function gradeExam() {
            let part1Score = 0, part2Score = 0;
            const results = {part1: [], part2: []};
            
            shuffledPart1.forEach(q => {
                const selected = document.querySelector('input[name="q' + q.id + '"]:checked');
                const userAnswer = selected ? parseInt(selected.value) : -1;
                const isCorrect = userAnswer === q.correct;
                if (isCorrect) part1Score += 0.25;
                results.part1.push({id: q.id, correct: isCorrect, userAnswer: userAnswer, correctAnswer: q.correct});
            });
            
            shuffledPart2.forEach(q => {
                let correctCount = 0;
                const subResults = [];
                q.subQuestions.forEach(sub => {
                    const selected = document.querySelector('input[name="q' + q.id + '_' + sub.id + '"]:checked');
                    const userAnswer = selected ? selected.value === 'true' : null;
                    const isCorrect = userAnswer === sub.correct;
                    if (isCorrect) correctCount++;
                    subResults.push({id: sub.id, correct: isCorrect, userAnswer: userAnswer, correctAnswer: sub.correct});
                });
                if (correctCount === 1) part2Score += 0.1;
                else if (correctCount === 2) part2Score += 0.25;
                else if (correctCount === 3) part2Score += 0.5;
                else if (correctCount === 4) part2Score += 1.0;
                results.part2.push({id: q.id, correctCount: correctCount, subResults: subResults});
            });
            
            return {
                part1Score: Math.round(part1Score * 100) / 100,
                part2Score: Math.round(part2Score * 100) / 100,
                totalScore: Math.round((part1Score + part2Score) * 100) / 100,
                results: results
            };
        }

        function displayResults(gradeResults) {
            const resultBox = document.getElementById('resultBox');
            const scoreDisplay = document.getElementById('scoreDisplay');
            const detailScore = document.getElementById('detailScore');
            
            scoreDisplay.innerHTML = 'Tổng điểm: ' + gradeResults.totalScore + '/10';
            detailScore.innerHTML = '<p style="text-align: center; font-size: 18px;">Phần I: ' + gradeResults.part1Score + '/6 điểm<br>Phần II: ' + gradeResults.part2Score + '/4 điểm</p>';
            resultBox.classList.add('show');
            
            gradeResults.results.part1.forEach(r => {
                const questionDiv = document.getElementById('p1q' + r.id);
                questionDiv.classList.add(r.correct ? 'correct' : 'incorrect');
                if (!r.correct) {
                    const correctLetter = String.fromCharCode(65 + r.correctAnswer);
                    const userLetter = r.userAnswer >= 0 ? String.fromCharCode(65 + r.userAnswer) : 'Không chọn';
                    const answerInfo = document.createElement('div');
                    answerInfo.innerHTML = '<div class="user-answer">Bạn chọn: ' + userLetter + '</div><div class="correct-answer">Đáp án đúng: ' + correctLetter + '</div>';
                    questionDiv.appendChild(answerInfo);
                }
            });
            
            gradeResults.results.part2.forEach(r => {
                const questionDiv = document.getElementById('p2q' + r.id);
                questionDiv.classList.add(r.correctCount === 4 ? 'correct' : 'incorrect');
                const answerInfo = document.createElement('div');
                answerInfo.innerHTML = '<div style="margin-top: 15px; padding: 10px; background: #fff3cd; border-radius: 5px;"><strong>Kết quả: ' + r.correctCount + '/4 ý đúng</strong><br>';
                r.subResults.forEach(sub => {
                    const icon = sub.correct ? '✓' : '✗';
                    const color = sub.correct ? '#2e7d32' : '#c62828';
                    const userText = sub.userAnswer === null ? 'Không chọn' : (sub.userAnswer ? 'Đúng' : 'Sai');
                    const correctText = sub.correctAnswer ? 'Đúng' : 'Sai';
                    answerInfo.innerHTML += '<div style="margin: 5px 0; color: ' + color + ';">' + icon + ' <strong>' + sub.id + ')</strong> Bạn chọn: <strong>' + userText + '</strong> - Đáp án: <strong>' + correctText + '</strong></div>';
                });
                answerInfo.innerHTML += '</div>';
                questionDiv.appendChild(answerInfo);
            });
        }

        function submitExam() {
            clearInterval(timerInterval);
            document.getElementById('submitBtn').disabled = true;
            document.querySelectorAll('input[type="radio"], input[type="checkbox"]').forEach(input => {
                input.disabled = true;
            });
            const gradeResults = gradeExam();
            displayResults(gradeResults);
            document.getElementById('resultBox').scrollIntoView({behavior: 'smooth'});
        }

        document.getElementById('submitBtn').addEventListener('click', submitExam);
        renderPart1();
        renderPart2();
        updateTimer();
    </script>
</body>
  </html>
